---
---
Redovisning kmom05
=========================

Det var riktigt roligt att använda PHP PDO och MySQL igen. Jag hade glömt en del så det var bra att fräscha upp kunskaperna igen. Det gick ganska lätt att komma igång eftersom det kändes bekant.

Det gick jättebra att överföra koden in i ramverket. Ramverket är smidigt att jobba med. Men jag stötte på två stora utmaningar. Den första var när jag ville testa min MovieController som då innehåller kontakt och förfrågningar till databas. Den andra stora utmaningen var sorteringen i kolumner. Jag ville gärna lösa det med POST variabler men hade problem att posta kolumnnamnet (orderby). Jag löste det så att jag byggde ihop orderby och order i en sträng, typ "id asc", och så fick min post action tolka det till två variabler.

Jag tycker att det gick bra att använda databasmodulen anax/database. Den var lätt att använda för utveckling och mer utmanande för enhetstestningen. Det är bra med såna här moduler för det blir ett gränssnitt med likadana operationer.

Det var en jätterolig slutuppgift. Jag valde att göra basfunktionaliteten (visa filmer, sök på år och titel samt CRUD) samt extrauppgifterna (reset av databasen, sortering av kolumneran, paginering och enkel inloggning). Jag gjorde sortering av kolumner och paginering och löste det genom att skicka infon via postvariabler. Det blir snyggare än att se informationen i strängen via GET. Dessutom så skalade jag bilderna med cimage vilket gjorde att alla fick samma storlek, mycket snyggare. Jag gjorde en enkel inloggning med en liten användardatabas med 2 användare. Jag refakturerade min MovieController och skapade en supportklass, DatabaseHelper som tar hand operationerna mot databasen. Jag försökte göra den så generell som möjligt för att kunna återanvända den senare.
Jag gjorde tester för min kontrollerklass och det var inte lätt. Men däremot väldigt bra för jag hittade två nullreferenser som blev fel i testerna men som ramverket snällt fixar ändå. För att kunna köra testerna fick jag sätta variabeln SERVER_NAME i setupen på kontrollertestklasserna. Eftersom jag har tre testfall med CRUD så behövde jag göra reset på databasen efter dem. Först löste jag det genom att resetmetoden i DatabaseHelper fick en testparameter men den lösningen är jag inte stolt över. Så jag testade att använda debug_tracker i resetmetoden för att ge rätt path till setup.sql. Kanske inte bra att använda debug_tracker så men det är en lösning i alla fall. Det finns säkert någon path man kan sätta i ramverket.

Min TIL med detta kursmoment är att det var väldigt engagerande och roligt. Jag la många timmar på testerna för kontrollerklassen men kom fram med en lösning. Jättenöjd! Jag fick tänka till på vad som var bra att testa på, i och med kopplingen till databasen. Jag kom fram till att min dator är utvecklingsmiljön och därför är det relevant och bra att köra testerna på min utvecklingsdatabas under förutsättning att jag gör reset efter testerna. Jag skulle däremot inte köra testerna på produktionsdatabasen, som i detta fall är databasen på studentservern, för den ska man inte testa på.
Detta kmom har känts bra, jag har lärt mig massor och har fått hel del självförtroende.
